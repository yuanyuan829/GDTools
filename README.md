# Geometry Dash 关卡编辑器

一个用于可视化编辑 Geometry Dash 关卡 plist 文件的 Python 程序。

## 功能特性

✨ **完整的文件格式支持**
- `.gmd` - 基础 Plist 格式
- `.lvl` - GZip 压缩的 Plist 格式
- `.gmd2` - Zip 打包格式 (包含 level.data 和 level.meta)

🎨 **可视化界面**
- 树形结构浏览关卡数据
- 直观的属性编辑器
- 支持多种数据类型 (字符串、整数、浮点数、布尔值、字典、列表)

✏️ **完整编辑功能**
- 查看和编辑任意属性
- 添加新的键值对
- 删除不需要的项
- 实时保存修改

## 安装

### 依赖要求

- Python 3.7+
- tkinter (通常 Python 自带)

### 快速开始

1. 确保已安装 Python 3.7 或更高版本
2. 克隆或下载此项目
3. 运行主程序:

```bash
python gmd_editor.py
```

## 使用方法

### 打开文件

1. 点击 "📁 打开" 按钮或使用快捷键 `Ctrl+O`
2. 选择你的 `.gmd`、`.lvl` 或 `.gmd2` 文件
3. 文件数据会以树形结构显示在左侧面板

### 编辑数据

1. 在左侧树形视图中选择要编辑的项
2. 在右侧编辑器中修改值
3. 选择正确的数据类型
4. 点击 "✅ 应用更改" 保存修改

### 添加新项

1. 选择一个字典或列表节点
2. 点击 "➕ 添加" 按钮
3. 输入键名(字典类型)和值
4. 选择数据类型
5. 确认添加

### 删除项

1. 选择要删除的项
2. 点击 "🗑️ 删除当前项" 按钮
3. 确认删除

### 保存文件

- **保存**: `Ctrl+S` 或点击 "💾 保存" 按钮
- **另存为**: 文件菜单 → 另存为

## 文件结构

```
GDquickclick/
├── gmd_parser.py          # GMD 文件解析核心模块
├── gmd_editor.py          # 完整版编辑器 (推荐使用)
├── gmd_editor_gui.py      # 基础版编辑器
├── GMD-API-main/          # 参考的 C++ API
└── README_GMD_Editor.md   # 本文档
```

## 技术细节

### GMD 文件格式

#### .gmd 格式
纯 XML plist 格式的关卡数据文件。

#### .lvl 格式
使用 zlib 压缩的 plist 文件,是较旧的格式。

#### .gmd2 格式
Zip 压缩包,包含:
- `level.data` - 关卡数据 (plist 格式)
- `level.meta` - 元数据 (JSON 格式)
- `*.mp3` - 可选的歌曲文件

### 核心模块说明

#### gmd_parser.py
提供 GMD 文件的读写功能:
- `GMDParser.read_gmd_file(path)` - 读取文件
- `GMDParser.save_gmd_file(path, data)` - 保存文件

#### gmd_editor.py
完整的图形界面编辑器:
- `DataManager` - 数据管理类
- `GMDEditorApp` - 主应用程序类

## 快捷键

| 快捷键 | 功能 |
|--------|------|
| `Ctrl+O` | 打开文件 |
| `Ctrl+S` | 保存文件 |
| `F5` | 刷新视图 |

## 注意事项

⚠️ **备份重要**
- 编辑前请备份原始文件
- 测试修改后的关卡是否能正常加载

⚠️ **数据类型**
- 确保使用正确的数据类型
- 整数用 `int`，小数用 `float`
- 布尔值只能是 `true` 或 `false`

⚠️ **字符编码**
- 文件使用 UTF-8 编码
- 支持中文和特殊字符

## 常见问题

### Q: 无法打开文件?
A: 确保文件格式正确,扩展名为 `.gmd`、`.lvl` 或 `.gmd2`

### Q: 修改后游戏无法加载关卡?
A: 检查数据类型是否正确,某些字段需要特定的数据类型

### Q: 如何查看原始 plist 数据?
A: 可以用文本编辑器打开 `.gmd` 文件,`.lvl` 和 `.gmd2` 需要先解压

## 开发参考

本项目基于 [GMD-API](https://github.com/HJfod/gmd-api) 的文件格式规范开发。

## 许可证

本项目仅供学习和研究使用。

## 更新日志

### v1.0 (2024)
- ✅ 支持 .gmd/.lvl/.gmd2 格式
- ✅ 完整的可视化编辑功能
- ✅ 数据类型转换
- ✅ 添加/删除节点
- ✅ 保存和另存为
